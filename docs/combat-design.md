# 戦闘システム設計書

## 交戦距離
| レンジ | 距離 | 用途 |
|--------|------|------|
| 密着 | 0〜2m | 通常コンボ・投げ・ガード崩し |
| 近接 | 2〜5m | リーチ長武器・チャージ攻撃・突進技 |
| 中距離 | 5〜15m | ダッシュ攻撃・一部スキル |
| 遠距離 | 15〜100m | 弓矢・投擲・大型スキル |

## 武器種（初期6種）
| 武器 | 射程 | 速度 | 威力 | スタイル |
|------|------|------|------|----------|
| 大剣 | 3m | 遅 | ★★★★★ | 広範囲薙ぎ払い・一撃重視 |
| 双剣 | 1.5m | 速 | ★★☆☆☆ | 手数型・連撃コンボ |
| 槍 | 4.5m | 中 | ★★★☆☆ | 突き特化・リーチ戦 |
| 戟 | 3.5m | 中 | ★★★★☆ | 打ち上げ・回転斬り |
| 拳 | 1m | 最速 | ★★☆☆☆ | 超近距離ラッシュ・投げ |
| 弓 | 100m | 遅 | ★★★☆☆ | 遠距離射撃・牽制 |

## コンボ構造
- 通常攻撃（□）: N1 → N2 → N3 → N4 → N5 → N6
- チャージ攻撃（△）: N[x] → △ で C[x] に派生
  - C1: ガード崩し系
  - C2: 打ち上げ（空中コンボ起点）
  - C3: 周囲360°薙ぎ払い
  - C4: 突進→吹き飛ばし
  - C5: 多段ヒット範囲攻撃
  - C6: 武器種固有の最大技

## ダメージ計算式
```
基礎ダメージ = ATK × モーション倍率
属性補正 = 属性相性テーブル参照
防御計算 = 基礎ダメージ × 属性補正 × (100 / (100 + DEF))
ガード時 = 最終ダメージ × 0.2
クリティカル = 5%確率で 1.5倍
```
※ 全計算はサーバー側で実行

## 被弾リアクション
- のけぞり（Flinch）: 軽攻撃
- よろめき（Stagger）: 重攻撃
- 打ち上げ（Launch）: C2系
- 叩きつけ（Slam）: 空中→地面
- 吹き飛ばし（Knockback）: C4系
- 気絶（Stun）: C1/投げ系

## ガード & 回避
- ガード: ダメージ80%カット、連続でガードブレイク
- ジャストガード（200ms窓）: ダメージ0 + 反撃確定
- 回避ステップ: 無敵6F(100ms) → 硬直12F(200ms)、最大3回連続

## ネットワーク同期方針
- ヒット判定: **サーバー権威** + ラグコンペンセーション（最大150ms）
- ヒットストップ: クライアント予測で即再生 → サーバー否認時取消
- 被弾リアクション: サーバーが命令、クライアントは演出のみ
- 無敵状態: サーバーのみが管理
